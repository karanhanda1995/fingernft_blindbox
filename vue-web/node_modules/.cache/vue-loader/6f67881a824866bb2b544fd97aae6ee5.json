{"remainingRequest":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\src\\components\\FollowPopup.vue?vue&type=style&index=1&id=05d8180a&lang=scss","dependencies":[{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\src\\components\\FollowPopup.vue","mtime":1650964597000},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\css-loader\\dist\\cjs.js","mtime":1652258042074},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1652258044998},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\postcss-loader\\src\\index.js","mtime":1652258043094},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1652258078791},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652258014056},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1652258044998}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5kaWFsb2ctZm9sbG93IHsKICAuZWwtZGlhbG9nX19ib2R5IHsKICAgIHBhZGRpbmctdG9wOiAwOwogIH0KfQo="},{"version":3,"sources":["C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\src\\components\\FollowPopup.vue"],"names":[],"mappings":";AA0SA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EAChB;AACF","file":"C:/Users/Mohamed Tamim/Desktop/SONGTRADER-V2-FULL/fingernft_blindbox/fingernft_blindbox/vue-web/src/components/FollowPopup.vue","sourceRoot":"","sourcesContent":["<template>\n  <el-dialog\n    custom-class=\"dialog-follow fg-dialog\"\n    destroy-on-close\n    :model-value=\"visible\"\n    :close-on-click-modal=\"false\"\n    :show-close=\"false\"\n    @open=\"openDialog\"\n    width=\"400px\"\n  >\n    <template #title>\n      <div class=\"fg-dialog-title\">\n        <div class=\"left\">\n          <span>{{ title }}</span>\n          <span class=\"dialog-title-num\">({{ total }})</span>\n        </div>\n        <div class=\"right\" @click=\"close\">\n          <img class=\"close-img\" src=\"@/assets/create-img/pop_shut.png\" />\n        </div>\n      </div>\n    </template>\n\n    <div class=\"follow-items\" v-infinite-scroll=\"loadList\">\n      <template v-if=\"loadStatus != 'loading' && !list.length\">\n        <!-- <no-content :tip=\"'No ' + title\"></no-content> -->\n        <no-content\n          v-if=\"title == 'Followers' || title == '关注者'\"\n          :tip=\"$t('account.nofollower')\"\n        >\n        </no-content>\n        <no-content\n          v-else-if=\"title == 'Following' || title == '正在关注'\"\n          :tip=\"$t('account.nofollowing')\"\n        >\n        </no-content>\n      </template>\n      <template v-else>\n        <div class=\"follow-item\" v-for=\"(item, i) in list\" :key=\"i\">\n          <avatar\n            class=\"avatar\"\n            :imageUrl=\"$filters.fullImageUrl(item.avatar)\"\n            :address=\"item.address\"\n            :imgWidth=\"60\"\n            :imgHeight=\"60\"\n            shape=\"circle\"\n            @click=\"goAccount(item)\"\n          ></avatar>\n          <div class=\"dialog-u-info\" @click=\"goAccount(item)\">\n            <span>{{ $t(\"MesPopup.followers\") }}</span>\n            <span class=\"dialog-u-name\">{{\n              item.nickname || $filters.ellipsisAddress(item.address)\n            }}</span>\n          </div>\n          <div class=\"right\" v-if=\"!connected || user.coinbase != item.address\">\n            <el-button\n              class=\"follow-btn custom-button\"\n              v-if=\"!item.isFollow\"\n              @click=\"addFollow(item, i)\"\n              >{{ $t(\"MesPopup.follow\") }}</el-button\n            >\n            <el-button\n              class=\"follow-btn\"\n              v-else\n              @click=\"deleteFollow(item, i)\"\n              >{{ $t(\"MesPopup.followed\") }}</el-button\n            >\n          </div>\n        </div>\n        <follow-load :loadStatus=\"loadStatus\"></follow-load>\n      </template>\n    </div>\n  </el-dialog>\n</template>\n<script>\nimport Avatar from \"./Avatar.vue\";\nexport default {\n  components: { Avatar },\n  name: \"MesPopup\",\n  props: {\n    show: {\n      type: Boolean,\n      default: false,\n    },\n    ftype: {\n      type: String,\n      default: \"\",\n    },\n    address: {\n      type: String,\n      default: \"\",\n    },\n  },\n  watch: {\n    show(val) {\n      this.visible = this.show;\n    },\n  },\n  emits: ['change','close'],\n  data() {\n    return {\n      loading: true,\n      list: [],\n      total: 0,\n      visible: this.show,\n      query: {\n        page: 1,\n        limit: this.$store.state.pageLimit,\n      },\n      loadStatus: \"\",\n    };\n  },\n  computed: {\n    connected() {\n      return this.$store.state.connected;\n    },\n    user() {\n      return this.$store.state.user;\n    },\n    title() {\n      if (this.ftype == \"follow\") {\n        return this.$t(\"account.Followers\");\n      }\n      return this.$t(\"account.Following\");\n    },\n  },\n  created() {\n    this.$nextTick(function () {\n      this.loading = false;\n    });\n  },\n  methods: {\n    close() {\n      this.$emit(\"close\");\n    },\n    goAccount(item) {\n      this.$router.push({ path: \"/account/\" + item.address });\n      this.$emit(\"close\");\n    },\n    openDialog() {\n      this.query.page = 1;\n      this.getList();\n    },\n    loadList() {\n      if (this.loadStatus == \"over\") return;\n      this.getList();\n    },\n    getList() {\n      if (this.loadStatus == \"loading\") return;\n      this.loadStatus = \"loading\";\n      let url = this.ftype == \"follow\" ? \"follow.follows\" : \"follow.followers\";\n      let params = { ...this.query, address: this.address };\n\n      this.$api(url, params).then((res) => {\n        this.loadStatus = \"loaded\";\n        if (this.$tools.checkResponse(res)) {\n          if (params.page == 1) this.list = [];\n          this.list = this.list.concat(res.data.list);\n          this.matchFollow(res.data.list);\n          this.query.page += 1;\n          this.total = res.data.total;\n          this.loadStatus =\n            res.data.list.length < res.data.limit ? \"over\" : this.loadStatus;\n        } else {\n          this.$tools.message(res.errmsg);\n        }\n      });\n    },\n    deleteFollow(item, index) {\n      let address = { address: item.address };\n      var that = this;\n      this.$api(\"follow.delete\", address).then((res) => {\n        if (that.$tools.checkResponse(res)) {\n          this.list[index].isFollow = false;\n          this.list[index].count = this.list[index].count - 1;\n          this.$emit(\"change\");\n        }else{\n          this.$tools.message(res.errmsg);\n        }\n      });\n    },\n    addFollow(item, index) {\n      let address = { address: item.address };\n      var that = this;\n      this.$api(\"follow.add\", address).then((res) => {\n        if (that.$tools.checkResponse(res)) {\n          that.list[index].isFollow = true;\n          that.list[index].count = that.list[index].count + 1;\n          this.$emit(\"change\");\n        }else{\n          this.$tools.message(res.errmsg);\n        }\n      });\n    },\n    matchFollow(list){\n      if(!this.connected || !list.length) return;\n      var addressList = [];\n      for(var i = 0; i < list.length; i++){\n        addressList.push(list[i].address);\n      }\n      addressList = addressList.join(\",\");\n      \n      var data = {\n        address: this.user.coinbase,\n        userAddrs: addressList,\n      }\n      this.$api(\"follow.match\", data).then(res => {\n        if(this.$tools.checkResponse(res)){\n          var followers = res.data;\n          var followerDict= {};\n          for(var i = 0; i < followers.length; i ++){\n            followerDict[followers[i].followingAddress] = true;\n          }\n          for(var i = 0; i < this.list.length; i++){\n            var address = this.list[i].address;\n            this.list[i].isFollow = followerDict[address] ? true : false;\n          }\n        }\n      });\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.dialog-follow {\n  .follow-item {\n    display: flex;\n    margin: 10px auto;\n    align-items: center;\n    .avatar {\n      cursor: pointer;\n    }\n    .dialog-u-info {\n      display: flex;\n      flex: 1;\n      flex-direction: column;\n      padding-left: 10px;\n      cursor: pointer;\n    }\n    .dialog-u-detail {\n      display: flex;\n      width: 160px;\n      justify-content: space-between;\n      .dialog-u-header {\n        width: 58px;\n        height: 58px;\n        border-radius: 50%;\n      }\n    }\n  }\n}\n.dialog-title {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-family: \"Montserrat-Regular\";\n  font-size: 24px;\n  font-weight: 400;\n}\n.dialog-title-colse {\n  border: none;\n  padding: 0;\n  .close-icon {\n    width: 34px;\n    height: 34px;\n  }\n}\n.dialog-title-num {\n  font-size: 16px;\n  padding-left: 15px;\n}\n.dialog-u-name {\n  font-weight: 400;\n  color: #1d1e22;\n}\n.skeleton-image {\n  width: 60px;\n  height: 60px;\n  border-radius: 10px;\n}\n.skeleton-list {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  height: 60px;\n  padding-left: 10px;\n  .skeleton-list1 {\n    width: 80px;\n    height: 18px;\n  }\n  .skeleton-list2 {\n    width: 120px;\n    height: 18px;\n    margin-top: 5px;\n  }\n}\n\n</style>\n<style lang = \"scss\">\n.dialog-follow {\n  .el-dialog__body {\n    padding-top: 0;\n  }\n}\n</style>\n"]}]}
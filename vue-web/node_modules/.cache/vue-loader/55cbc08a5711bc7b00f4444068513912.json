{"remainingRequest":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\src\\components\\dialogs\\Collection.vue?vue&type=style&index=0&id=96da279c&lang=scss","dependencies":[{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\src\\components\\dialogs\\Collection.vue","mtime":1650964597000},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\css-loader\\dist\\cjs.js","mtime":1652258042074},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1652258044998},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\postcss-loader\\src\\index.js","mtime":1652258043094},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1652258078791},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652258014056},{"path":"C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1652258044998}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgLmNvbGxlY3Rpb24tZGlhbG9nLWlucHV0IHsKICAgIC5lbC1pbnB1dC1ncm91cF9fcHJlcGVuZCB7CiAgICAgIHBhZGRpbmctbGVmdDogMCAhaW1wb3J0YW50OwogICAgfQogIH0K"},{"version":3,"sources":["C:\\Users\\Mohamed Tamim\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-web\\src\\components\\dialogs\\Collection.vue"],"names":[],"mappings":";EAuVE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC5B;EACF","file":"C:/Users/Mohamed Tamim/Desktop/SONGTRADER-V2-FULL/fingernft_blindbox/fingernft_blindbox/vue-web/src/components/dialogs/Collection.vue","sourceRoot":"","sourcesContent":["<template>\n  <el-dialog :model-value=\"visible\" :show-close=\"false\" :close-on-click-modal=\"false\" @closed=\"closed\" custom-class=\"fg-dialog collection-dialog\" destroy-on-close>\n    <template #title>\n      <div class=\"fg-dialog-title\">\n        <div class=\"left\">{{ $t(\"create.title\") }}</div>\n        <div class=\"right\" @click=\"$emit('close')\">\n          <img class=\"close-img\" src=\"@/assets/create-img/pop_shut.png \" />\n        </div>\n      </div>\n    </template>\n    <div class=\"fg-dialog-body\" v-if=\"!confirm\">\n      <div class=\"process\">\n        <div class=\"upload-wrapper\">\n          <div class=\"upload-box\">\n            <div class=\"pic-preview\">\n              <el-image :src=\"tempImg\" fit=\"cover\">\n                <template #error>\n                  <div class=\"image-slot\"></div>\n                </template>\n              </el-image>\n            </div>\n            <div class=\"pic-upload\" v-if=\"!tempImg\">\n              <el-upload ref=\"uploadFile\" class=\"upload-pic\" accept=\"image/gif,image/png,image/jpeg,image/webp\" :limit=\"1\" :auto-upload=\"false\" action=\"\"\n                  :on-change=\"(file, fileList) => { uploadChange(file, fileList, 'uploadFile'); }\" \n                  name=\"image\" :showFileList=\"false\">\n                <template #tip>\n                  <div class=\"upload-tip\">{{ $t(\"create.fileTip\") }}</div>\n                </template>\n                <el-button size=\"small\" class=\"choose-btn\" type=\"primary\" plain>\n                  {{ $t(\"erc721.chooseFile\") }}</el-button>\n              </el-upload>\n            </div>\n            <div class=\"pic-upload\" v-else>\n              <div class=\"upload-pic\">\n                <el-button class=\"delete-btn\" size=\"small\" type=\"primary\" @click=\"deletePic\" plain>\n                  {{ $t(\"erc721.deletePicture\") }}\n                </el-button>\n                <span class=\"upload-tip\">{{ $t(\"create.fileTip\") }}</span>\n              </div>\n            </div>\n          </div>\n          <div class=\"form-error-tip error-position\">\n            {{ formError.file }}\n          </div>\n        </div>\n        <div class=\"input-group\">\n          <div class=\"input-info\">\n            <div class=\"tip\">\n              {{ $t(\"create.displayName\") }}\n              <span class=\"gray-font\"> ({{ $t(\"dialog.required\") }})</span>\n            </div>\n            <el-input class=\"fg-dialog-input\" :placeholder=\"$t('create.placeName')\" v-model=\"form.displayName\"></el-input>\n            <div class=\"input-error\" v-if=\"formError.displayName\">\n              {{ formError.displayName }}\n            </div>\n            <div class=\"stip\">\n              <div class=\"stip-item\">{{ $t(\"create.nameTip\") }}</div>\n            </div>\n          </div>\n          <div class=\"input-info\">\n            <div class=\"tip\">\n              {{ $t(\"create.symbol\")\n              }}<span class=\"gray-font\"> ({{ $t(\"dialog.required\") }})</span>\n            </div>\n            <el-input class=\"fg-dialog-input\" :placeholder=\"$t('create.placeSymbol')\" v-model=\"form.symbol\"></el-input>\n            <div class=\"input-error\" v-if=\"formError.symbol\"> {{ formError.symbol }} </div>\n          </div>\n          <div class=\"input-info\">\n            <div class=\"tip\">{{ $t(\"create.introduction\") }}</div>\n            <el-input class=\"fg-dialog-input\" :placeholder=\"$t('create.placeIntro')\" v-model=\"form.introduction\"></el-input>\n          </div>\n\n        </div>\n        <div class=\"process-btn\">\n          <el-button @click=\"onSubmit\" type=\"primary\" :loading=\"confirm\">{{ $t(\"dialog.createCollection\") }}\n          </el-button>\n        </div>\n      </div>\n    </div>\n    <div class=\"fg-dialog-body\" v-else>\n      <div class=\"process\">\n        <div class=\"step-info\">\n          <div class=\"text\">\n            <span>{{ $t(\"dialog.approveCollection\") }}</span>\n          </div>\n          <span v-if=\"step.upload != 1\" :class=\"step.upload == 2 ? 'finish' : ''\" class=\"step iconfont icon-seleted\"></span>\n          <div class=\"step loading\" v-else>\n            <img class=\"loading-animation\" src=\"@/assets/img/loading.png\" />\n          </div>\n        </div>\n        <div class=\"process-btn\">\n          <el-button @click=\"onUpload\" type=\"primary\" v-if=\"step.upload == 0\">{{ $t(\"dialog.upload\") }}</el-button>\n          <el-button disabled type=\"info\" v-else-if=\"step.upload == 1\">{{\n            $t(\"dialog.inProgress\")\n          }}</el-button>\n          <el-button disabled type=\"info\" v-else>{{\n            $t(\"dialog.done\")\n          }}</el-button>\n        </div>\n        <div class=\"process-error\" v-if=\"error.upload\">\n          {{ error.upload}}\n        </div>\n      </div>\n      <div class=\"process\">\n        <div class=\"step-info\">\n          <div class=\"text\">\n            <span>{{ $t(\"dialog.signsCollection\") }}</span>\n          </div>\n          <span v-if=\"step.collection != 1\" :class=\"step.collection == 2 ? 'finish' : ''\" class=\"step iconfont icon-seleted\"></span>\n          <div class=\"step loading\" v-else>\n            <img class=\"loading-animation\" src=\"@/assets/img/loading.png\" />\n          </div>\n        </div>\n        <div class=\"process-btn\">\n          <el-button disabled type=\"info\" v-if=\"step.upload != 2\">\n            {{ $t(\"dialog.createCollection\") }}\n          </el-button>\n          <el-button @click=\"onCollection\" type=\"primary\" v-else-if=\"step.collection == 0\">\n            {{ $t(\"dialog.createCollection\") }}\n          </el-button>\n          <el-button disabled type=\"info\" v-else-if=\"step.collection == 1\">\n            {{ $t(\"dialog.inProgress\") }}\n          </el-button>\n          <el-button disabled type=\"info\" v-else>\n            {{ $t(\"dialog.done\") }}\n          </el-button>\n        </div>\n        <div class=\"process-error\" v-if=\"error.collection\">\n          {{ error.collection }}\n        </div>\n      </div>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\n  export default {\n    data () {\n      return {\n        visible: this.show,\n        confirm: false,\n        tempImg: null,\n        form: {\n          file: \"\",\n          displayName: \"\",\n          symbol: \"\",\n          introduction: \"\",\n        },\n        formError: {\n          file: \"\",\n          displayName: \"\",\n          symbol: \"\",\n        },\n        step: {\n          upload: 0,\n          collection: 0,\n        },\n        error: {\n          all: \"\",\n          upload: \"\",\n          collection: \"\",\n        },\n      };\n    },\n    emits: ['confirm', 'close'],\n    props: {\n      show: {\n        type: Boolean,\n        default: false,\n      },\n      ercType: {\n        type: Number,\n        default: \"\",\n      },\n    },\n    computed: {\n      user: function () {\n        return this.$store.state.user;\n      },\n      config(){\n        return this.$store.state.config;\n      },\n    },\n    watch: {\n      show (val) {\n        this.visible = this.show;\n      },\n    },\n    methods: {\n      closed () {\n        this.tempImg = null;\n        this.confirm = false;\n        this.form = {\n          file: \"\",\n          displayName: \"\",\n          symbol: \"\",\n          introduction: \"\",\n        };\n        this.formError = {\n          file: \"\",\n          displayName: \"\",\n          symbol: \"\",\n        };\n        this.step = {\n          upload: 0,\n          collection: 0,\n        };\n        this.error = {\n          all: \"\",\n          upload: \"\",\n          collection: \"\",\n        };\n      },\n      uploadChange (file) {\n        let size = file.raw.size;\n        if (size > 30 * 1024 * 1024) {\n          this.errorForm.file = this.$t(\"form.limitFile\");\n          return;\n        }\n        this.form.file = file.raw;\n        var event = event || window.event;\n        var file = event.target.files[0];\n        var reader = new FileReader();\n        var _this = this;\n        reader.onload = function (e) {\n          _this.tempImg = e.target.result;\n        };\n        reader.readAsDataURL(file);\n      },\n      deletePic () {\n        this.tempImg = null;\n        this.form.file = null;\n      },\n      checkForm () {\n        this.formError = {\n          file: \"\",\n          displayName: \"\",\n          symbol: \"\",\n        };\n        let result = true;\n        if (!this.form.file) {\n          this.formError.file = this.$t(\"form.noFile\");\n          result = false;\n        }\n        if (!this.form.displayName) {\n          this.formError.displayName = this.$t(\"form.noDisplayName\");\n          result = false;\n        }\n        if (!this.form.symbol) {\n          this.formError.symbol = this.$t(\"form.noSymbol\");\n          result = false;\n        }\n        return result;\n      },\n      async onSubmit () {\n        let that = this;\n        if (!this.checkForm()) return;\n        this.confirm = true;\n        setTimeout(async function () {\n          await that.onUpload();\n        }, 100);\n      },\n      async createUpload () {\n        let result = await this.uploadStorage(this.form.file);\n        if (result.error) {\n          return { error: result.errmsg };\n        }\n        let data = {\n          name: this.form.displayName,\n          symbol: this.form.symbol,\n          description: this.form.introduction,\n          storageId: result.id,\n          cover: result.url,\n          signer: this.config.miner,\n          type: this.ercType,\n          owner: this.user.coinbase,\n        };\n        await this.$api(\"contract.create\", data).then((res) => {\n          if (this.$tools.checkResponse(res)) {\n            result = {};\n          } else {\n            result = { error: res.errmsg };\n          }\n        });\n        return result;\n      },\n      async uploadStorage (file) {\n        return new Promise((resolve) => {\n          const formData = new FormData();\n          formData.append(\"file\", file);\n          var that = this;\n          this.$api(\"storage.upload\", formData).then(async function (res) {\n            if (that.$tools.checkResponse(res)) {\n              resolve(res.data);\n            } else {\n              resolve({\n                error: res.errmsg,\n              });\n            }\n          });\n        });\n      },\n      async onCollection () {\n        this.step.collection = 1;\n        let result = await this.createContract();\n        if (result.error) {\n          this.error.collection = result.error;\n          this.step.collection = 0;\n        } else {\n          this.error.collection = \"\";\n          this.step.collection = 2;\n          this.$emit(\"confirm\");\n        }\n      },\n      async createContract () {\n        let asset = { name: this.form.displayName, symbol: this.form.symbol };\n        asset.miner = this.config.miner;\n        if (this.ercType === 3) {\n          asset.contractURI = \"ipfs:/\";\n          asset.uri = \"ipfs:/\";\n          return this.$sdk.newERC721(this.user.coinbase, asset);\n        } else if (this.ercType === 2) {\n          asset.contractURI = \"ipfs:/\";\n          asset.uri = \"ipfs:/\";\n          return this.$sdk.newERC1155(this.user.coinbase, asset);\n        }\n      },\n      async onUpload () {\n        this.step.upload = 1;\n        let result = await this.createUpload();\n        if (result.error) {\n          this.error.upload = result.error;\n          this.step.upload = 0;\n        } else {\n          this.error.upload = \"\";\n          this.step.upload = 2;\n        }\n      },\n    },\n  };\n</script>\n\n<style lang=\"scss\">\n  .collection-dialog-input {\n    .el-input-group__prepend {\n      padding-left: 0 !important;\n    }\n  }\n</style>\n\n<style lang=\"scss\" scoped>\n  .upload-wrapper {\n    padding-bottom: 20px;\n  }\n  .upload-box {\n    display: flex;\n  }\n\n  .pic-preview {\n    width: 100px;\n    height: 100px;\n    flex-shrink: 0;\n    .el-image {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n    }\n    .image-slot {\n      height: 100%;\n      background-color: #f6f6f6;\n    }\n  }\n  .pic-upload {\n    margin-left: 16px;\n    .upload-pic {\n      height: 100%;\n      display: flex;\n      flex-direction: column-reverse;\n      justify-content: space-between;\n      align-items: flex-start;\n    }\n  }\n  .form-error-tip {\n    padding-top: 5px;\n  }\n</style>\n"]}]}
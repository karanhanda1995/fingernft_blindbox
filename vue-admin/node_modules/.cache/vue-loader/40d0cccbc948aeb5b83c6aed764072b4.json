{"remainingRequest":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\src\\views\\blindBoxManagement\\nftManagement.vue?vue&type=style&index=0&id=52b32643&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\src\\views\\blindBoxManagement\\nftManagement.vue","mtime":1650964597000},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":1652081880732},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1652081880145},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1652081880241},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1652081887366},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652081880827},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1652081880134}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmF2YXRhci11cGxvYWRlciAuZWwtdXBsb2FkIHsKCWJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5OwoJYm9yZGVyLXJhZGl1czogNnB4OwoJY3Vyc29yOiBwb2ludGVyOwoJcG9zaXRpb246IHJlbGF0aXZlOwoJb3ZlcmZsb3c6IGhpZGRlbjsKfQouYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQ6aG92ZXIgewoJYm9yZGVyLWNvbG9yOiAjMjBhMGZmOwp9Ci5hdmF0YXItdXBsb2FkZXItaWNvbiB7Cglmb250LXNpemU6IDI4cHg7Cgljb2xvcjogIzhjOTM5ZDsKCXdpZHRoOiAxMjBweDsKCWhlaWdodDogMTIwcHg7CglsaW5lLWhlaWdodDogMTIwcHg7Cgl0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KLmF2YXRhciB7Cgl3aWR0aDogMTQ1cHg7CgloZWlnaHQ6IDE0NXB4OwoJZGlzcGxheTogYmxvY2s7Cn0KCi5lbC10YWJsZV9fcm93IGF1ZGlvIHsKCXdpZHRoOiA4MCU7Cn0KCi5wcm9wZXJ0eS1ncm91cCB7CglkaXNwbGF5OiBmbGV4OwoJZmxleC1kaXJlY3Rpb246IHJvdzsKCW1hcmdpbi1ib3R0b206IDE1cHg7CgkucHJvcGVydHkgewoJCWZsZXg6IDE7Cgl9CgkubGVmdCB7CgkJcGFkZGluZy1yaWdodDogNDBweDsKCX0KfQouZWwtdXBsb2FkIGF1ZGlvIHsKCXdpZHRoOiAzMDBweDsKfQo="},{"version":3,"sources":["nftManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAigBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"nftManagement.vue","sourceRoot":"src/views/blindBoxManagement","sourcesContent":["<template>\n\t<div class=\"app-container\">\n\t\t<div class=\"filter-container\">\n\t\t\t<el-input v-model=\"listQuery.name\" clearable class=\"filter-item w-200 mr-10\" :placeholder=\"$t('blind.placeholder')\" />\n\t\t\t<el-button class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handlerFilter\">{{ $t(\"blind.select\") }}</el-button>\n\t\t\t<el-button class=\"filter-item\" type=\"primary\" icon=\"el-icon-edit\" v-permission=\"['POST /admin/blind/nft/add']\" @click.native.prevent=\"handlerBtn('add')\">{{ $t(\"blind.add\") }}</el-button>\n\t\t</div>\n\t\t<!-- 表格 -->\n\t\t<el-table v-loading=\"listLoading\" :data=\"list\" :element-loading-text=\"$t('util.loadingText')\" border>\n\t\t\t<el-table-column type=\"expand\">\n\t\t\t\t<template slot-scope=\"props\">\n\t\t\t\t\t<el-form label-position=\"left\" inline class=\"table-expand\">\n\t\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.blindType')\">\n\t\t\t\t\t\t\t<span>{{ blindTypeName(props.row.address) }}</span>\n\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.property')\">\n\t\t\t\t\t\t\t<span>{{ props.row.propertys }}</span>\n\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.brief')\">\n\t\t\t\t\t\t\t<span>{{ props.row.description }}</span>\n\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.address')\">\n\t\t\t\t\t\t\t<span>{{ props.row.address }}</span>\n\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.tokenId')\">\n\t\t\t\t\t\t\t<span>{{ props.row.tokenId }}</span>\n\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t</el-form>\n\t\t\t\t</template>\n\t\t\t</el-table-column>\n\t\t\t<el-table-column align=\"center\" label=\"ID\" prop=\"id\" sortable></el-table-column>\n\t\t\t<el-table-column align=\"center\" :label=\"$t('blind.nft.name')\" prop=\"name\"></el-table-column>\n\t\t\t<el-table-column align=\"center\" :label=\"$t('blind.nft.picture')\" prop=\"metadataContent\" width=\"200px\">\n\t\t\t\t<template slot-scope=\"scope\" v-if=\"scope.row.metadataContent.image\">\n\t\t\t\t\t<media :isPreview=\"true\" :url=\"scope.row.metadataContent.image\" type=\"image\"></media>\n\t\t\t\t</template>\n\t\t\t</el-table-column>\n\t\t\t<el-table-column align=\"center\" :label=\"$t('blind.nft.audioORvideo')\" prop=\"metadataContent\">\n\t\t\t\t<template slot-scope=\"scope\" v-if=\"scope.row.metadataContent.animation_url\">\n\t\t\t\t\t<media :url=\"scope.row.metadataContent.animation_url\" :isPreview=\"true\"></media>\n\t\t\t\t</template>\n\t\t\t</el-table-column>\n\t\t\t<el-table-column align=\"center\" :label=\"$t('blind.operation')\" width=\"300\" class-name=\"small-padding fixed-width\">\n\t\t\t\t<template slot-scope=\"scope\">\n\t\t\t\t\t<el-button type=\"danger\" size=\"mini\" @click.native.prevent=\"handlerBtn('del', scope.row)\" v-permission=\"['POST /admin/blind/nft/deleted']\">{{ $t(\"blind.delete\") }}</el-button>\n\t\t\t\t</template>\n\t\t\t</el-table-column>\n\t\t</el-table>\n\n\t\t<pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.limit\" @pagination=\"getList\" />\n\n\t\t<el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogFormVisible\" :width=\"dialogStatus === 'del' ? '30%' : '50%'\">\n\t\t\t<template v-if=\"dialogStatus === 'add'\">\n\t\t\t\t<el-form ref=\"formData\" :model=\"formData\" status-icon label-position=\"left\" label-width=\"120px\" :rules=\"rules\">\n\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.blindType')\" prop=\"address\">\n\t\t\t\t\t\t<el-select v-model=\"formData.address\" :placeholder=\"$t('blind.nft.pleaseSelect')\">\n\t\t\t\t\t\t\t<el-option v-for=\"(blindType, index) in blindTypes\" :key=\"index\" :label=\"blindType.name\" :value=\"blindType.address\">\n\t\t\t\t\t\t\t</el-option>\n\t\t\t\t\t\t</el-select>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.name')\" prop=\"name\">\n\t\t\t\t\t\t<el-input v-model=\"formData.name\"></el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.brief')\" prop=\"description\">\n\t\t\t\t\t\t<el-input type=\"textarea\" v-model=\"formData.description\"></el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.picture')\" prop=\"imgUrl\">\n\t\t\t\t\t\t<!-- <el-upload ref=\"upload\" action=\"\" :auto-upload=\"false\" :show-file-list=\"false\" :file-list=\"fileListImage\" :limit=\"1\" class=\"avatar-uploader\"\n              accept=\"image/jpg, image/jpeg, image/png, image/gif\" :on-change=\"(file) => { uploadChange(file, 'uploadImage'); }\">\n              <template v-if=\"formData.imgUrl\">\n                <media :url=\"formData.imgUrl\" type=\"image\"></media>\n              </template>\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n            </el-upload> -->\n\t\t\t\t\t\t<upload-unit v-if=\"dialogFormVisible\" :refName=\"'blindboxNftImgRef'\" :limitNum=\"1\" :imageData=\"formData.imgUrl\" :uploadStatus=\"dialogStatus == 'add'\" @updateData=\"updateNftImg\"></upload-unit>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.audioORvideo')\" prop=\"animUrl\">\n\t\t\t\t\t\t<!-- <el-upload ref=\"upload\" action=\"\" :auto-upload=\"false\" :show-file-list=\"false\" :file-list=\"fileListVideo\" :limit=\"1\" class=\"avatar-uploader\"\n              accept=\"audio/mp3, audio/wav, audio/oga, video/webm, video/mp4, video/m4v, video/ogg, video/ogv, video/mov\" :on-change=\" (file) => { uploadChange(file, 'uploadVideo'); }\">\n              <template v-if=\"formData.animUrl\">\n                <media :url=\"formData.animUrl\" :type=\"formData.videoType\"></media>\n              </template>\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n            </el-upload> -->\n\t\t\t\t\t\t<upload-unit v-if=\"dialogFormVisible\" :refName=\"'blindboxNftGifRef'\" :limitNum=\"1\" :imageData=\"formData.animUrl\" :uploadStatus=\"dialogStatus == 'add'\" @updateData=\"updateNftGif\"></upload-unit>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t\t<el-form-item :label=\"$t('blind.nft.property')\">\n\t\t\t\t\t\t<div class=\"property-group\" v-for=\"(property, i) in formData.properties\" :key=\"i\">\n\t\t\t\t\t\t\t<div class=\"property left\">\n\t\t\t\t\t\t\t\t<el-input v-model=\"property.key\" :placeholder=\"$t('blind.property.key')\" @input=\"propertyInput\">\n\t\t\t\t\t\t\t\t</el-input>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"property right\">\n\t\t\t\t\t\t\t\t<el-input v-model=\"property.value\" :placeholder=\"$t('blind.property.value')\" @input=\"propertyInput\">\n\t\t\t\t\t\t\t\t</el-input>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</el-form>\n\t\t\t</template>\n\t\t\t<!-- 删除 -->\n\t\t\t<template v-if=\"dialogStatus === 'del'\">\n\t\t\t\t<span>{{ $t(\"blind.deleteTip\") }}</span>\n\t\t\t</template>\n\t\t\t<!-- 底部按钮 -->\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\n\t\t\t\t<el-button @click.native.prevent=\"handlerCancel\">{{\n          $t(\"blind.cancel\")\n        }}</el-button>\n\t\t\t\t<el-button :loading=\"apiLoading\" type=\"primary\" @click.native.prevent=\"handlerConfirm\">{{ $t(\"blind.confirm\") }}</el-button>\n\t\t\t</span>\n\t\t</el-dialog>\n\t</div>\n</template>\n\n<script>\n\timport Pagination from \"@/components/Pagination\";\n\timport Media from \"@/components/Media\";\n\timport UploadUnit from \"@/components/Upload.vue\"\n\texport default {\n\t\tname: \"nft\",\n\t\tcomponents: { Pagination, Media, UploadUnit },\n\t\tdata () {\n\t\t\treturn {\n\t\t\t\tlistLoading: true,\n\t\t\t\tapiLoading: false,\n\t\t\t\tlist: [],\n\t\t\t\ttotal: 0,\n\t\t\t\tlistQuery: {\n\t\t\t\t\tpage: 1,\n\t\t\t\t\tlimit: 10,\n\t\t\t\t\tname: \"\",\n\t\t\t\t},\n\t\t\t\t// 弹出框\n\t\t\t\tdialogFormVisible: false,\n\t\t\t\tdialogStatus: \"\",\n\t\t\t\tdelId: \"\",\n\t\t\t\t//   表单\n\t\t\t\tformData: {\n\t\t\t\t\taddress: \"\",\n\t\t\t\t\tname: \"\",\n\t\t\t\t\tdescription: \"\",\n\t\t\t\t\tstorageId: \"\",\n\t\t\t\t\timgUrl: \"\",\n\t\t\t\t\tanimStorageId: \"\",\n\t\t\t\t\tanimUrl: \"\",\n\t\t\t\t\tvideoType: \"\",\n\t\t\t\t\tproperties: [{ key: \"\", value: \"\" }],\n\t\t\t\t},\n\t\t\t\trules: {\n\t\t\t\t\taddress: {\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tmessage: this.$t(\"blind.nft.emptyType\"),\n\t\t\t\t\t\ttrigger: \"change\",\n\t\t\t\t\t},\n\t\t\t\t\timgUrl: {\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tmessage: this.$t(\"blind.nft.emptyPicture\"),\n\t\t\t\t\t\ttrigger: \"blur\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// 上传\n\t\t\t\tfileImage: \"\",\n\t\t\t\tfileVideo: \"\",\n\t\t\t\tfileListImage: [],\n\t\t\t\tfileListVideo: [],\n\t\t\t};\n\t\t},\n\t\tcomputed: {\n\t\t\tblindTypes () {\n\t\t\t\treturn this.$store.state.user.blindTypes;\n\t\t\t},\n\t\t\tdialogTitle () {\n\t\t\t\tlet dialogTitle = \"\";\n\t\t\t\tswitch (this.dialogStatus) {\n\t\t\t\t\tcase \"add\":\n\t\t\t\t\t\tdialogTitle = this.$t(\"blind.add\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"edit\":\n\t\t\t\t\t\tdialogTitle = this.$t(\"blind.edit\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"del\":\n\t\t\t\t\t\tdialogTitle = this.$t(\"blind.delete\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"sync\":\n\t\t\t\t\t\tdialogTitle = this.$t(\"blind.sync\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn dialogTitle;\n\t\t\t},\n\t\t\tblindTypeName () {\n\t\t\t\treturn function (address) {\n\t\t\t\t\tfor (let i = 0, len = this.blindTypes.length;i < len;i++) {\n\t\t\t\t\t\tif (this.blindTypes[i].address === address)\n\t\t\t\t\t\t\treturn this.blindTypes[i].name;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t},\n\t\tcreated () {\n\t\t\tthis.getList();\n\t\t},\n\t\tmethods: {\n\t\t\tgetList () {\n\t\t\t\tthis.listLoading = true;\n\t\t\t\tthis.$api(\"blind.nft.list\", this.listQuery)\n\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\tthis.formatData(res.data.list);\n\t\t\t\t\t\tthis.list = res.data.list;\n\t\t\t\t\t\tthis.total = res.data.total;\n\t\t\t\t\t\tthis.listLoading = false;\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\tthis.list = [];\n\t\t\t\t\t\tthis.total = 0;\n\t\t\t\t\t\tthis.listLoading = false;\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tupdateNftImg (file) {\n\t\t\t\tthis.formData.imgUrl = file\n\t\t\t\tthis.fileImage = file\n\t\t\t},\n\t\t\tupdateNftGif (file) {\n\t\t\t\tthis.formData.animUrl = file\n\t\t\t\tthis.fileVideo = file\n\t\t\t},\n\t\t\tformatData (data) {\n\t\t\t\tfor (let i = 0, len = data.length;i < len;i++) {\n\t\t\t\t\tif (data[i].metadataContent) {\n\t\t\t\t\t\tdata[i].metadataContent = JSON.parse(data[i].metadataContent);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata[i].metadataContent = { image: \"\", animation_url: \"\" };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tresetForm () {\n\t\t\t\tthis.formData = {\n\t\t\t\t\taddress: \"\",\n\t\t\t\t\tname: \"\",\n\t\t\t\t\tdescription: \"\",\n\t\t\t\t\tstorageId: \"\",\n\t\t\t\t\timgUrl: \"\",\n\t\t\t\t\tanimStorageId: \"\",\n\t\t\t\t\tanimUrl: \"\",\n\t\t\t\t\tvideoType: \"\",\n\t\t\t\t\tproperties: [{ key: \"\", value: \"\" }],\n\t\t\t\t};\n\t\t\t\tthis.fileImage = \"\";\n\t\t\t\tthis.fileVideo = \"\";\n\t\t\t},\n\t\t\t// handler--property\n\t\t\tpropertyInput (e) {\n\t\t\t\tlet emptyC = 0;\n\t\t\t\tfor (var i = 0;i < this.formData.properties.length;i++) {\n\t\t\t\t\tvar property = this.formData.properties[i];\n\t\t\t\t\tif (!property.key || !property.value) emptyC += 1;\n\t\t\t\t}\n\t\t\t\tif (emptyC != 1) {\n\t\t\t\t\tthis.formData.properties = this.formData.properties.filter(function (\n\t\t\t\t\t\tproperty\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn property.key || property.value;\n\t\t\t\t\t});\n\t\t\t\t\tthis.formData.properties.push({ key: \"\", value: \"\" });\n\t\t\t\t}\n\t\t\t\tthis.formData = JSON.parse(JSON.stringify(this.formData));\n\t\t\t},\n\t\t\tfullProperties (properties) {\n\t\t\t\tvar _properties = [];\n\t\t\t\tfor (var i = 0;i < properties.length;i++) {\n\t\t\t\t\tvar key = properties[i].key.trim();\n\t\t\t\t\tvar value = properties[i].value.trim();\n\t\t\t\t\tif (!key || !value) continue;\n\t\t\t\t\tvar trait_type = key;\n\t\t\t\t\t_properties.push({ key, value, trait_type });\n\t\t\t\t}\n\t\t\t\treturn _properties;\n\t\t\t},\n\t\t\t// 图片改变\n\t\t\tuploadChange (files, uploadType) {\n\t\t\t\tif (uploadType === \"uploadImage\") {\n\t\t\t\t\tthis.fileListImage = [];\n\t\t\t\t\tthis.fileImage = files.raw;\n\t\t\t\t}\n\t\t\t\tif (uploadType === \"uploadVideo\") {\n\t\t\t\t\tthis.fileListVideo = [];\n\t\t\t\t\tthis.fileVideo = files.raw;\n\t\t\t\t}\n\t\t\t\tvar event = event || window.event;\n\t\t\t\tvar file = event.target.files[0];\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\tvar _this = this;\n\t\t\t\treader.onload = function (e) {\n\t\t\t\t\tif (uploadType === \"uploadImage\") {\n\t\t\t\t\t\t_this.formData.imgUrl = e.target.result;\n\t\t\t\t\t}\n\t\t\t\t\tif (uploadType === \"uploadVideo\") {\n\t\t\t\t\t\t_this.formData.animUrl = e.target.result;\n\t\t\t\t\t\t_this.formData.videoType = file.type;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treader.readAsDataURL(file);\n\t\t\t},\n\t\t\thandlerUploadImage () {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet formData = new FormData();\n\t\t\t\t\tformData.append(\"file\", this.fileImage);\n\t\t\t\t\tformData.append(\"flag\", \"ipfs\");\n\t\t\t\t\tthis.$api(\"storage.create\", formData)\n\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\tif (this.$tool.checkResponse(res)) {\n\t\t\t\t\t\t\t\tresolve(res.data);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treject(res);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\thandlerUploadVideo () {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet formData = new FormData();\n\t\t\t\t\tformData.append(\"files\", this.fileVideo);\n\t\t\t\t\tformData.append(\"files\", this.fileImage);\n\t\t\t\t\tthis.$api(\"storage.multiupload\", formData)\n\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\tif (this.$tool.checkResponse(res)) {\n\t\t\t\t\t\t\t\tresolve(res.data);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treject(res);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 表单数据增、删、改、查\n\t\t\taddData () {\n\t\t\t\tthis.$refs[\"formData\"].validate((valid) => {\n\t\t\t\t\tif (valid && !this.apiLoading) {\n\t\t\t\t\t\tthis.apiLoading = true;\n\t\t\t\t\t\tlet promiseArr = [];\n\t\t\t\t\t\tif (this.fileVideo) {\n\t\t\t\t\t\t\tpromiseArr = [this.handlerUploadVideo()];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromiseArr = [this.handlerUploadImage()];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tPromise.all(promiseArr)\n\t\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\t\tthis.addForm(res);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\t\tthis.failCallback();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\taddForm (fileData) {\n\t\t\t\tlet {\n\t\t\t\t\taddress,\n\t\t\t\t\tname,\n\t\t\t\t\tdescription,\n\t\t\t\t\tstorageId,\n\t\t\t\t\timgUrl,\n\t\t\t\t\tanimStorageId,\n\t\t\t\t\tanimUrl,\n\t\t\t\t\tvideoType,\n\t\t\t\t\tproperties,\n\t\t\t\t} = this.formData;\n\t\t\t\tif (fileData) {\n\t\t\t\t\tstorageId = this.fileVideo ? fileData[0][1].id : fileData[0].id;\n\t\t\t\t\timgUrl = this.fileVideo\n\t\t\t\t\t\t? fileData[0][1].ipfshash\n\t\t\t\t\t\t: fileData[0].ipfshash;\n\t\t\t\t\tanimStorageId = this.fileVideo ? fileData[0][0].id : \"\";\n\t\t\t\t\tanimUrl = this.fileVideo ? fileData[0][0].ipfshash : \"\";\n\t\t\t\t\tvideoType = this.fileVideo ? fileData[0][0].type : \"\";\n\t\t\t\t} else {\n\t\t\t\t\tstorageId = imgUrl = animStorageId = animUrl = videoType = \"\";\n\t\t\t\t}\n\t\t\t\tlet propertys = this.fullProperties(properties);\n\t\t\t\tpropertys = JSON.stringify(propertys);\n\t\t\t\tlet sendData = {\n\t\t\t\t\taddress,\n\t\t\t\t\tname,\n\t\t\t\t\tdescription,\n\t\t\t\t\ttype: 5,\n\t\t\t\t\tstorageId,\n\t\t\t\t\timgUrl,\n\t\t\t\t\tanimStorageId,\n\t\t\t\t\tanimUrl,\n\t\t\t\t\tvideoType,\n\t\t\t\t\tpropertys,\n\t\t\t\t};\n\t\t\t\tthis.$api(\"blind.nft.add\", sendData)\n\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\tif (this.$tool.checkResponse(res)) {\n\t\t\t\t\t\t\tthis.successCallback();\n\t\t\t\t\t\t\tthis.getList();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.failCallback();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\tthis.failCallback(err);\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tdelData () {\n\t\t\t\tif (!this.apiLoading) {\n\t\t\t\t\tthis.apiLoading = true;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.$api(\"blind.nft.deleted\", { id: this.delId })\n\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\tif (this.$tool.checkResponse(res)) {\n\t\t\t\t\t\t\tthis.successCallback();\n\t\t\t\t\t\t\tlet { page, limit } = this.listQuery;\n\t\t\t\t\t\t\tif (page > 1 && this.total - 1 - (page - 1) * limit <= 0) {\n\t\t\t\t\t\t\t\tthis.listQuery.page -= 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.total -= 1;\n\t\t\t\t\t\t\tthis.getList();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.failCallback();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\tthis.failCallback(err);\n\t\t\t\t\t});\n\t\t\t},\n\t\t\thandlerFilter () {\n\t\t\t\tthis.listQuery.page = 1;\n\t\t\t\tthis.getList();\n\t\t\t},\n\t\t\t/*\n\t\t\t * 按钮执行弹窗\n\t\t\t * #handlerBtn\n\t\t\t */\n\t\t\thandlerBtn (btnType, row = {}) {\n\t\t\t\tswitch (btnType) {\n\t\t\t\t\tcase \"add\":\n\t\t\t\t\t\tthis.resetForm();\n\t\t\t\t\t\tthis.$nextTick(function () {\n\t\t\t\t\t\t\tthis.$refs[\"formData\"]\n\t\t\t\t\t\t\t\t? this.$refs[\"formData\"].clearValidate()\n\t\t\t\t\t\t\t\t: \"\";\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"del\":\n\t\t\t\t\t\tthis.delId = row.id;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.dialogFormVisible = true;\n\t\t\t\tthis.dialogStatus = btnType;\n\t\t\t},\n\t\t\t// 确定按钮回调\n\t\t\thandlerConfirm () {\n\t\t\t\tswitch (this.dialogStatus) {\n\t\t\t\t\tcase \"add\":\n\t\t\t\t\t\tthis.addData();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"edit\":\n\t\t\t\t\t\tthis.editData();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"del\":\n\t\t\t\t\t\tthis.delData();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"sync\":\n\t\t\t\t\t\tthis.syncData();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 取消按钮回调\n\t\t\thandlerCancel () {\n\t\t\t\tthis.dialogFormVisible = false;\n\t\t\t},\n\t\t\t// 请求成功回调\n\t\t\tsuccessCallback () {\n\t\t\t\tthis.$notify.success({\n\t\t\t\t\ttitle: this.$t(\"blind.success\"),\n\t\t\t\t\tmessage: this.$t(\"blind.messageSuccess\"),\n\t\t\t\t});\n\t\t\t\tthis.handlerCancel();\n\t\t\t\tthis.apiLoading = false;\n\t\t\t},\n\t\t\t// 请求失败回调\n\t\t\tfailCallback (err) {\n\t\t\t\tthis.apiLoading = false;\n\t\t\t\tthis.$notify.error({\n\t\t\t\t\ttitle: this.$t(\"blind.fail\"),\n\t\t\t\t\tmessage: err\n\t\t\t\t\t\t? this.$t(\"response.\" + err.data ? err.data.errno : \"\")\n\t\t\t\t\t\t: this.$t(\"blind.messageFail\"),\n\t\t\t\t});\n\t\t\t\tif (this.dialogStatus == \"del\") {\n\t\t\t\t\tthis.handlerCancel();\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t};\n</script>\n\n<style lang=\"scss\" scoped>\n\t.avatar-uploader .el-upload {\n\t\tborder: 1px dashed #d9d9d9;\n\t\tborder-radius: 6px;\n\t\tcursor: pointer;\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t}\n\t.avatar-uploader .el-upload:hover {\n\t\tborder-color: #20a0ff;\n\t}\n\t.avatar-uploader-icon {\n\t\tfont-size: 28px;\n\t\tcolor: #8c939d;\n\t\twidth: 120px;\n\t\theight: 120px;\n\t\tline-height: 120px;\n\t\ttext-align: center;\n\t}\n\t.avatar {\n\t\twidth: 145px;\n\t\theight: 145px;\n\t\tdisplay: block;\n\t}\n\n\t.el-table__row audio {\n\t\twidth: 80%;\n\t}\n\n\t.property-group {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin-bottom: 15px;\n\t\t.property {\n\t\t\tflex: 1;\n\t\t}\n\t\t.left {\n\t\t\tpadding-right: 40px;\n\t\t}\n\t}\n\t.el-upload audio {\n\t\twidth: 300px;\n\t}\n</style>\n"]}]}
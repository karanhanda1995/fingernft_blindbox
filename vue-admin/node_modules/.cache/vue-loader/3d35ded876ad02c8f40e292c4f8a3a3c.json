{"remainingRequest":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\src\\views\\blindBoxManagement\\supplier.vue?vue&type=style&index=0&id=5141f6d8&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\src\\views\\blindBoxManagement\\supplier.vue","mtime":1650964597000},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":1652081880732},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1652081880145},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1652081880241},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1652081887366},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652081880827},{"path":"C:\\Users\\97154\\Desktop\\SONGTRADER-V2-FULL\\fingernft_blindbox\\fingernft_blindbox\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1652081880134}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lbC1mb3JtLWl0ZW1fX2xhYmVsIHsKICB3aWR0aDogMjAwcHggIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["supplier.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsTA;AACA;AACA","file":"supplier.vue","sourceRoot":"src/views/blindBoxManagement","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"filter-container\">\n      <el-input v-model=\"listQuery.name\" clearable class=\"filter-item w-200 mr-10\" :placeholder=\"$t('blind.placeholder')\" />\n      <el-button class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handlerFilter\">{{$t(\"blind.select\")}}</el-button>\n      <el-button class=\"filter-item\" type=\"primary\" icon=\"el-icon-edit\" @click=\"handlerBtn('add')\" v-permission=\"['POST /admin/blind/type/add']\">{{$t('global.add')}}</el-button>\n    </div>\n    <el-table v-loading=\"listLoading\" :data=\"list\" :element-loading-text=\"$t('util.loadingText')\" border>\n      <el-table-column label=\"ID\" prop=\"id\" sortable></el-table-column>\n      <el-table-column :label=\"$t('blind.type.name')\" prop=\"name\"></el-table-column>\n      <el-table-column :label=\"$t('global.contractAddress')\" prop=\"address\"></el-table-column>\n      <el-table-column align=\"center\" :label=\"$t('blind.operation')\" width=\"300\" class-name=\"small-padding fixed-width\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" size=\"mini\" @click=\"handlerBtn('edit', scope.row)\" v-permission=\"['POST /admin/blind/type/edit']\">{{$t('blind.edit')}}</el-button>\n          <el-button type=\"danger\" size=\"mini\" @click=\"handlerBtn('del', scope.row)\" v-permission=\"['POST /admin/blind/type/delete']\">{{$t('blind.delete')}}</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.limit\" @pagination=\"getList\" />\n    <!-- 弹窗 -->\n    <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogFormVisible\" :width=\"dialogStatus === 'del' ? '30%' : '50%'\" @closed=\"resetForm\">\n      <template v-if=\"dialogStatus === 'add' || dialogStatus === 'edit'\">\n        <el-form ref=\"formData\" :model=\"formData\" status-icon label-position=\"left\" label-width=\"120px\" :rules=\"rules\">\n          <el-form-item :label=\"$t('blind.type.name')\" prop=\"name\">\n            <el-input v-model=\"formData.name\"></el-input>\n          </el-form-item>\n          <el-form-item :label=\"$t('global.contractAddress')\" prop=\"address\">\n            <el-input v-model=\"formData.address\"></el-input>\n            <div class=\"m-top-10\">\n              <el-button size=\"small\" v-if=\"!connected\" type=\"primary\" @click=\"connect\">{{ $t(\"navbar.connectWallet\") }}</el-button>\n              <el-button size=\"small\" v-else :loading=\"deployLoading\" type=\"primary\" @click=\"deploy\">{{ $t(\"global.deploy\") }}</el-button>\n            </div>\n\n          </el-form-item>\n          <div class=\"error-tip text-center\" v-if=\"formError\">\n            {{ formError}}\n          </div>\n        </el-form>\n      </template>\n      <template v-if=\"dialogStatus === 'del'\">\n        <span>{{$t('blind.deleteTip')}}</span>\n      </template>\n      <!-- 底部按钮 -->\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"handlerCancel\">{{$t('blind.cancel')}}</el-button>\n        <el-button :loading=\"apiLoading\" type=\"primary\" @click.native.prevent=\"handlerConfirm\">{{$t('blind.confirm')}}</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  import Pagination from \"@/components/Pagination\";\n  import deploy from \"@/utils/sdk/deploy.js\";\n  import { mapActions } from 'vuex';\n  export default {\n    name: \"supplier\",\n    components: { Pagination },\n    data () {\n      return {\n        apiLoading: false,\n        listLoading: true,\n        list: null,\n        total: 0,\n        address: null,\n        listQuery: {\n          page: 1,\n          limit: 10,\n          name: undefined\n        },\n        formData: {\n          name: \"\",\n          address: \"\",\n        },\n        formError: \"\",\n        deployLoading: false,\n        rules: {\n          name: [\n            { required: true, message: this.$t('blind.type.emptyName'), trigger: \"blur\" },\n          ],\n          address: [\n            { required: true, message: this.$t('blind.type.emptyContractAddress'), trigger: \"blur\" },\n          ],\n        },\n        dialogFormVisible: false,\n        dialogStatus: \"\",\n        delId: \"\",\n      };\n    },\n    created () {\n      this.getList();\n    },\n    computed: {\n      connected () {\n        var connected = this.$store.state.network.connected;\n        return connected;\n      },\n      configContract(){\n        var config = this.$store.state.app.config;\n        console.log(\"config\", config);\n        return config.configContract;\n      },\n      dialogTitle () {\n        let dialogTitle = \"\";\n        switch (this.dialogStatus) {\n          case \"add\":\n            dialogTitle = this.$t('blind.add');\n            break;\n          case \"edit\":\n            dialogTitle = this.$t('blind.edit');\n            break;\n          case \"del\":\n            dialogTitle = this.$t('blind.delete');\n            break;\n          default:\n            break;\n        }\n        return dialogTitle;\n      },\n    },\n    methods: {\n      ...mapActions(['blindTypes']),\n      getList () {\n        this.listLoading = true;\n        this.$api(\"blind.type.list\", this.listQuery)\n          .then((res) => {\n            this.list = res.data.list;\n            this.total = res.data.total;\n            this.listLoading = false;\n          })\n          .catch(() => {\n            this.list = [];\n            this.total = 0;\n            this.listLoading = false;\n          });\n      },\n      resetForm () {\n        this.formData = {\n          name: \"\",\n          address: \"\",\n        };\n        this.formError = \"\";\n        this.deployLoading = false;\n      },\n      connect () {\n        this.$store.dispatch(\"connect\");\n      },\n      async deploy () {\n        if (!this.formData.name) {\n          this.formError = this.$t('blind.type.emptyName');\n          return;\n        }\n        console.log(\"this.configContract\", this.configContract);\n        if(!this.configContract.copyErc721Address){\n          this.formError = this.$t('blind.type.emptyCopyERC721');\n          return;\n        }\n        this.deployLoading = true;\n        this.formError = \"\";\n        var params = [\n          this.formData.name,\n          this.formData.name,\n          this.configContract.copyErc721Address,\n          \"ipfs:/\",\n          \"ipfs:/\"\n        ];\n        const result = await deploy(\"Box721\", params);\n        this.deployLoading = false;\n        if (result.error) {\n          this.formError = result.error;\n          return;\n        }\n        this.formData = Object.assign({}, this.formData, {\n          address: result.address,\n        });\n      },\n      handlerFilter () {\n        this.listQuery.page = 1;\n        this.getList();\n      },\n      // 按钮执行弹窗\n      handlerBtn (btnType, row = {}) {\n        if (btnType === \"add\") {\n          this.resetForm();\n          this.$nextTick(function () {\n            this.$refs[\"formData\"] ? this.$refs[\"formData\"].clearValidate() : \"\";\n          });\n        }\n        if (btnType === \"edit\") {\n          this.formData = Object.assign({}, row);\n          this.$nextTick(function () {\n            this.$refs[\"formData\"] ? this.$refs[\"formData\"].clearValidate() : \"\";\n          });\n        }\n        if (btnType === \"del\") {\n          this.address = row.address;\n        }\n        this.dialogFormVisible = true;\n        this.dialogStatus = btnType;\n      },\n      // 确定按钮回调\n      handlerConfirm () {\n        if (this.dialogStatus === \"add\") {\n          this.addData();\n        }\n        if (this.dialogStatus === \"edit\") {\n          this.editData();\n        }\n        if (this.dialogStatus === \"del\") {\n          this.delData();\n        }\n      },\n      // 取消按钮回调\n      handlerCancel () {\n        this.dialogFormVisible = false;\n      },\n      addData () {\n        this.$refs[\"formData\"].validate((valid) => {\n          if (valid && !this.apiLoading) {\n            this.apiLoading = true;\n            this.$api(\"blind.type.add\", this.formData)\n              .then((res) => {\n                if (this.$tool.checkResponse(res)) {\n                  this.successCallback()\n                  this.getList();\n                  this.blindTypes()\n                } else {\n                  this.failCallback()\n                }\n              })\n              .catch((err) => {\n                this.failCallback(err)\n              });\n          }\n        });\n      },\n      editData () {\n        this.$refs[\"formData\"].validate((valid) => {\n          if (valid && !this.apiLoading) {\n            this.apiLoading = true;\n            this.$api(\"blind.type.edit\", this.formData)\n              .then((res) => {\n                if (this.$tool.checkResponse(res)) {\n                  this.successCallback()\n                  this.getList();\n                  this.blindTypes()\n                } else {\n                  this.failCallback()\n                }\n              })\n              .catch((err) => {\n                this.failCallback(err)\n              });\n          }\n        });\n      },\n      delData () {\n        if (!this.apiLoading) {\n          this.apiLoading = true;\n        } else {\n          return;\n        }\n        this.$api(\"blind.type.delete\", { address: this.address })\n          .then((res) => {\n            if (this.$tool.checkResponse(res)) {\n              this.successCallback()\n              let { page, limit } = this.listQuery;\n              if (page > 1 && this.total - 1 - (page - 1) * limit <= 0) {\n                this.listQuery.page -= 1;\n              }\n              this.total -= 1;\n              this.getList();\n              this.blindTypes()\n            } else {\n              this.failCallback()\n            }\n          })\n          .catch((err) => {\n            this.failCallback(err)\n          });\n      },\n\n      // 请求成功回调\n      successCallback () {\n        this.$notify.success({\n          title: this.$t(\"blind.success\"),\n          message: this.$t(\"blind.messageSuccess\"),\n        });\n        this.handlerCancel();\n        this.apiLoading = false;\n      },\n      // 请求失败回调\n      failCallback (err) {\n        this.apiLoading = false;\n        this.$notify.error({\n          title: this.$t(\"blind.fail\"),\n          message: err\n            ? this.$t(\"response.\" + err.data ? err.data.errno : \"\")\n            : this.$t(\"blind.messageFail\"),\n        });\n        if (this.dialogStatus == \"del\") {\n          this.handlerCancel()\n        }\n      },\n    },\n  };\n</script>\n\n<style lang=\"scss\" scoped>\n  .el-form-item__label {\n    width: 200px !important;\n  }\n</style>\n"]}]}